<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Rate Limiting &mdash; Intel® QuickAssist Technology  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/qat.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Power Management" href="infrastructure_power_management.html" />
    <link rel="prev" title="Telemetry" href="infrastructure_device_telemetry.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> Intel® QuickAssist Technology
          </a>
              <div class="version">
                Hardware Version 2.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../qat/legal.html">Legal Notices &amp; Disclaimers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Intro/introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Intro/terminology.html">Terminology</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ReleaseNotes/index.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../GSG/GSG2/index.html">Getting Started Guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Programmer’s Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="introduction.html">About this Document</a></li>
<li class="toctree-l2"><a class="reference internal" href="architecture.html">Architecture</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="infrastructure_index.html">Infrastructure</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="infrastructure_queue_pairs.html">Queues and Queue Pairs</a></li>
<li class="toctree-l3"><a class="reference internal" href="infrastructure_service_instances.html">Service Instances</a></li>
<li class="toctree-l3"><a class="reference internal" href="infrastructure_memory_management.html">Memory Management</a></li>
<li class="toctree-l3"><a class="reference internal" href="infrastructure_modes_of_operation.html">Modes of Operation</a></li>
<li class="toctree-l3"><a class="reference internal" href="infrastructure_load_balancing.html">Load Balancing</a></li>
<li class="toctree-l3"><a class="reference internal" href="infrastructure_debugability.html">Debugability</a></li>
<li class="toctree-l3"><a class="reference internal" href="infrastructure_heartbeat.html">Heartbeat</a></li>
<li class="toctree-l3"><a class="reference internal" href="infrastructure_device_telemetry.html">Telemetry</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Rate Limiting</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#service-level-agreement-sla">Service Level Agreement (SLA)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#sla-units">SLA Units</a></li>
<li class="toctree-l4"><a class="reference internal" href="#sla-manager-application">SLA Manager Application</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="infrastructure_power_management.html">Power Management</a></li>
<li class="toctree-l3"><a class="reference internal" href="infrastructure_ras.html">Reliability, Availability, and Stability (RAS)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="acceleration_driver.html">Acceleration Driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration_files_index.html">Configuration Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="services_index.html">Services</a></li>
<li class="toctree-l2"><a class="reference internal" href="apis_index.html">Supported APIs</a></li>
<li class="toctree-l2"><a class="reference internal" href="virtualization.html">Virtualization</a></li>
<li class="toctree-l2"><a class="reference internal" href="security.html">Secure Architecture Considerations</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../VIRT/index.html">Virtualization Deployment Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../qat/contact.html">Contact</a></li>
<li class="toctree-l1"><a class="reference internal" href="../qat/contact.html#support">Support</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Intel® QuickAssist Technology</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="index.html">Programmer’s Guide</a> &raquo;</li>
          <li><a href="infrastructure_index.html">Infrastructure</a> &raquo;</li>
      <li>Rate Limiting</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="rate-limiting">
<span id="qat-2-0-pg-infrastructure-rate-limiting"></span><h1>Rate Limiting<a class="headerlink" href="#rate-limiting" title="Permalink to this headline"></a></h1>
<p>Rate Limiting is implemented by monitoring the utilization of the device on a per-VF, per-service basis and comparing that to the SLA allocated to that VF and service. Resources are shared across guests and the resource utilization of each guest is measured relative to the capacity of the physical function.</p>
<p>The feature is supported only for SYM and ASYM services.</p>
<p>To enable the Rate Limiting feature:</p>
<ol class="arabic simple">
<li><p><strong>Install</strong> the driver package on the host with Single-Root Input/Output Virtualization (SR-IOV) enabled.</p></li>
<li><p><strong>Set</strong> <code class="docutils literal notranslate"><span class="pre">ServicesEnabled</span></code> to <code class="docutils literal notranslate"><span class="pre">asym</span></code> or <code class="docutils literal notranslate"><span class="pre">sym</span></code>.</p></li>
<li><p><strong>Perform</strong> <code class="docutils literal notranslate"><span class="pre">qat_service</span> <span class="pre">shutdown</span></code> and <code class="docutils literal notranslate"><span class="pre">qat_service</span> <span class="pre">start</span></code>.</p></li>
</ol>
<section id="service-level-agreement-sla">
<h2>Service Level Agreement (SLA)<a class="headerlink" href="#service-level-agreement-sla" title="Permalink to this headline"></a></h2>
<p>Service Level Agreement enforcement allocates a specified amount of capacity for a specified service to a specified VF:
<em>max SLA enforced = (number of VFs) X (number of services)</em> where:</p>
<blockquote>
<div><ul class="simple">
<li><p>Number of VFs varies based on device type</p></li>
<li><p>Number of services = 2 (asymmetric or symmetric)</p></li>
</ul>
</div></blockquote>
</section>
<section id="sla-units">
<h2>SLA Units<a class="headerlink" href="#sla-units" title="Permalink to this headline"></a></h2>
<p>SLA units are measured as follows:</p>
<ul class="simple">
<li><p>Symmetric Crypto – 1Mbps of throughput.</p></li>
<li><p>Asymmetric Crypto – 1 operation (ops) of reference operation.</p></li>
</ul>
</section>
<section id="sla-manager-application">
<h2>SLA Manager Application<a class="headerlink" href="#sla-manager-application" title="Permalink to this headline"></a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">sla_mgr</span></code> tool is used to create, update, delete, list and get SLA capabilities.
The SLA Manager executable is available in <code class="docutils literal notranslate"><span class="pre">$ICP_ROOT/build/sla_mgr</span></code> after the package is built and installed using <code class="docutils literal notranslate"><span class="pre">./configure;</span> <span class="pre">make</span> <span class="pre">install</span></code> commands.</p>
<section id="sla-commands">
<h3>SLA Commands<a class="headerlink" href="#sla-commands" title="Permalink to this headline"></a></h3>
<table class="docutils align-default" id="id1">
<caption><span class="caption-text">Rate Limiting SLA Commands</span><a class="headerlink" href="#id1" title="Permalink to this table"></a></caption>
<colgroup>
<col style="width: 28%" />
<col style="width: 72%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>Operation</strong></p></th>
<th class="head"><p><strong>Command</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Create SLA</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">./sla_mgr</span> <span class="pre">create</span> <span class="pre">&lt;vf_addr&gt;</span> <span class="pre">&lt;rate_in_sla_units&gt;</span> <span class="pre">&lt;service&gt;</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Update SLA</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">./sla_mgr</span> <span class="pre">update</span> <span class="pre">&lt;pf_addr&gt;</span> <span class="pre">&lt;sla_id&gt;</span> <span class="pre">&lt;rate_in_sla_units&gt;</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Delete SLA</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">./sla_mgr</span> <span class="pre">delete</span> <span class="pre">&lt;pf_addr&gt;</span> <span class="pre">&lt;sla_id&gt;</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Delete all SLAs</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">./sla_mgr</span> <span class="pre">delete_all</span> <span class="pre">&lt;pf_addr&gt;</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Query SLA capabilities</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">./sla_mgr</span> <span class="pre">caps</span> <span class="pre">&lt;pf_addr&gt;</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Query list of SLAs</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">./sla_mgr</span> <span class="pre">list</span> <span class="pre">&lt;pf_addr&gt;</span></code></p></td>
</tr>
</tbody>
</table>
<p>Options:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">pf_addr</span></code> - Physical address in domain:bus:device.function(xxxx:xx:xx.x) format.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">vf_addr</span></code> - Virtual address in domain:bus:device.function(xxxx:xx:xx.x) format.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Service</span></code> - Asym(=0) or Sym(=1).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rate_in_sla_units</span></code> - [ 0-MAX]. MAX is found by querying the capabilities.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sla_id</span></code> - Value returned by <code class="docutils literal notranslate"><span class="pre">create</span></code> command.</p></li>
</ul>
<p>One <code class="docutils literal notranslate"><span class="pre">rate_in_sla_units</span></code> is equal to:</p>
<ul class="simple">
<li><p>1 operation per second - for asymmetric service.</p></li>
<li><p>1 Megabits per second - for symmetric service/compression service.</p></li>
</ul>
</section>
<section id="sla-manager-application-demo">
<h3>SLA Manager Application Demo<a class="headerlink" href="#sla-manager-application-demo" title="Permalink to this headline"></a></h3>
<p>Here is a demonstration of using the <code class="docutils literal notranslate"><span class="pre">sla_mgr</span></code> tool to create, update, and delete SLAs.
The device utilization script from the previous section is used to visualize the SLAs in action.
The demo consists of the following steps:</p>
<ol class="arabic simple">
<li><p><strong>Run</strong> Encryption workload without SLA in place to observe full utilization.</p></li>
<li><p><strong>Create</strong> SLA enabling 75% of bandwidth and observe reduced utilization.</p></li>
<li><p><strong>Update</strong> the SLA to enable 25% of bandwidth and observe reduced utilization.</p></li>
<li><p><strong>Remove</strong> the SLA and verify full utilization.</p></li>
</ol>

    <video width="600" height="300" controls >
    <source src="../_static/video/pg/ratelimiting.mp4" type="video/mp4">
    Video
    </video>
    <div class="line-block">
<div class="line"><br /></div>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="infrastructure_device_telemetry.html" class="btn btn-neutral float-left" title="Telemetry" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="infrastructure_power_management.html" class="btn btn-neutral float-right" title="Power Management" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright Intel Corporation.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>