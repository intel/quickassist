<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Known Issues &mdash; Intel® QuickAssist Technology  documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/collapsible-lists/css/tree_view.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/qat.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/clipboard.min.js"></script>
        <script src="../../../_static/copybutton.js"></script>
        <script src="../../../_static/collapsible-lists/js/CollapsibleLists.compressed.js"></script>
        <script src="../../../_static/collapsible-lists/js/apply-collapsible-lists.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../../index.html" class="icon icon-home"> Intel® QuickAssist Technology
          </a>
              <div class="version">
                Hardware Version 2.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../qat_general/legal.html">Legal Notices &amp; Disclaimers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Intro/introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Intro/terminology.html">Terminology</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../index.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../GSG/2.X/index.html">Getting Started Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../PG/index.html">Programmer’s Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../VIRT/index.html">Virtualization Deployment Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../PERF/index.html">Performance Optimization Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../qatlib/index.html">QATlib User’s Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../AppNotes/index.html">Application Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../API_PG/index.html">API Programmer’s Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api_reference.html">API Reference Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../qat_general/contact.html">Contact &amp; Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../qat_general/collateral_list.html">Documentation &amp; Resources</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Intel® QuickAssist Technology</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Known Issues</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="known-issues">
<span id="qat-1-x-rn-vmware-knownissues"></span><h1>Known Issues<a class="headerlink" href="#known-issues" title="Permalink to this headline"></a></h1>
<section id="issues-relating-to-violation-of-trust-model">
<h2>Issues Relating to Violation of Trust Model<a class="headerlink" href="#issues-relating-to-violation-of-trust-model" title="Permalink to this headline"></a></h2>
<p>The second generation of Intel<sup>®</sup> QAT was designed with performance as
the primary objective. To attain the best possible performance, applications
are exposed directly to the hardware with no bounds checking. This approach
implies a trusted programming model, wherein an application is expected to
supply correctly formatted addresses and arguments at the API.</p>
<p>An application failing to follow the programming conventions runs the risk of
negatively impacting the platform.</p>
</section>
<section id="qate-7495-an-incorrectly-formatted-requests-to-intel-qat-can-render-the-intel-qat-endpoint-unresponsive">
<h2>QATE-7495 - An Incorrectly formatted requests to Intel<sup>®</sup> QAT can render the Intel<sup>®</sup> QAT endpoint unresponsive<a class="headerlink" href="#qate-7495-an-incorrectly-formatted-requests-to-intel-qat-can-render-the-intel-qat-endpoint-unresponsive" title="Permalink to this headline"></a></h2>
<table class="docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>Title</strong></p></td>
<td><p>An Incorrectly formatted request to Intel<sup>®</sup> QAT can render the
Intel<sup>®</sup> QAT endpoint unresponsive</p></td>
</tr>
<tr class="row-even"><td><p><strong>Reference</strong></p></td>
<td><p>QATE-7495</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Description</strong></p></td>
<td><p>This version of the Intel<sup>®</sup> QAT hardware does not perform
exhaustive request address and parameter checking. It follows that a
malicious application could submit requests that can bring down an
entire Intel<sup>®</sup> QAT endpoint or platform itself, which can impact
other Intel<sup>®</sup> QAT jobs associated with the hardware. This
presents a risk that must be managed by the host and guest operating
systems and other system policies. The exposure can extend to other
guest operating systems or applications outside of the typical access
boundary of the malicious guest or application.</p>
<p>Conditions like invalid address, address range that crosses the SecureRAM
boundaries, and invalid request can cause HW to hang or system reset.</p>
</td>
</tr>
<tr class="row-even"><td><p><strong>Implication</strong></p></td>
<td><p>All guest operating systems and applications using QAT must be trusted,
and/or other steps must be taken to ensure that an untrusted application
or guest cannot submit incorrectly formatted requests.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Resolution</strong></p></td>
<td><p>There is no workaround available. However, system policies
(including limiting specific operating system permissions) can help to
mitigate this issue.</p></td>
</tr>
<tr class="row-even"><td><p><strong>Related issues</strong></p></td>
<td><p>QATE-14706 - Partial descriptor submission may cause hang</p>
<p>QATE-14287 - IOMMU page fault provokes device hang</p>
<p>QATE-15430 - Malformed NULL descriptor may cause hang</p>
<p>QATE-30895 - Crossing SecureRAM boundaries may cause device hang</p>
<p>QATE-39377 - Continuous submitting malformed requests in VM may cause
the platform to hang or reboot</p>
<p>Root Cause Analysis:</p>
<p>When a non-posted transaction is initiated to an invalid target
(bad memory address), a UR is returned. Later, a Completion Time Out
happens. A tag is issued to the non-posted transaction, and a tag is
returned by the UR and a tag is returned by the CTO. This means that for
every one tag issued, two are returned. This causes unexpected overflows
in counters, too many outstanding transactions, and eventually leads to
system instability and a crash.</p>
</td>
</tr>
</tbody>
</table>
</section>
<section id="qate-30251-turning-off-bus-master-enable-may-cause-pf-hang">
<h2>QATE-30251 - Turning off Bus Master Enable may cause PF hang<a class="headerlink" href="#qate-30251-turning-off-bus-master-enable-may-cause-pf-hang" title="Permalink to this headline"></a></h2>
<table class="docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>Title</strong></p></td>
<td><p>Turning off Bus Master Enable may cause PF hang</p></td>
</tr>
<tr class="row-even"><td><p><strong>Reference</strong></p></td>
<td><p>QATE-30251</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Description</strong></p></td>
<td><p>Specific guest’s operations to rings with disabled BME bit may cause PF
to hang.</p></td>
</tr>
<tr class="row-even"><td><p><strong>Implication</strong></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Resolution</strong></p></td>
<td><p>If PF hangs, the system administrator should shut down all the VMs and
manually reload the driver or restart the whole system.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="qate-64395-usage-of-dc-session-update-api-can-render-the-application-unresponsive">
<h2>QATE-64395 - Usage of DC Session Update API can render the application unresponsive<a class="headerlink" href="#qate-64395-usage-of-dc-session-update-api-can-render-the-application-unresponsive" title="Permalink to this headline"></a></h2>
<table class="docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>Title</strong></p></td>
<td><p>Usage of DC Session Update API can render the application unresponsive</p></td>
</tr>
<tr class="row-even"><td><p><strong>Reference</strong></p></td>
<td><p>QATE-64395</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Description</strong></p></td>
<td><p>In case of using Linux driver 4.10 with DC Session Update API user may
get a timeout and fatal errors in Guest OS dmesg:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>c6xxvf 0000:ff:00.0: Fatal error received from PF 0x6ac20013
</pre></div>
</div>
</td>
</tr>
<tr class="row-even"><td><p><strong>Implication</strong></p></td>
<td><p>The application which is using the mentioned API may get a
timeout-related error or stuck on waiting for a response from HW</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Resolution</strong></p></td>
<td><p>Use smaller chunks for submission or increase timeout values in the
application that is using Intel<sup>®</sup> QAT. Also, possible to
increase a Heartbeat and Quiesce timeouts for PF driver itself via the
following steps:</p>
<ol class="arabic">
<li><p>Power off all VMs that are using Intel<sup>®</sup> QAT hardware</p></li>
<li><p>Unload driver:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">&gt; esxcfg-module -u icp_qat_pf</span>
</pre></div>
</div>
</li>
<li><p>Load driver module via next command where hb_interval is ranged from
500 to 5000 ms and quiesce_timeout is from 350 to 20000 ms:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">&gt; esxcli system module parameters set -m icp_qat_pf -p &quot;hb_interval=5000 quiesce_timeout=20000&quot;</span>
</pre></div>
</div>
</li>
<li><p>Reset device manager:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">&gt; kill -HUP $(cat /var/run/vmware/vmkdevmgr.pid)</span>
</pre></div>
</div>
</li>
</ol>
<p>To reset <code class="docutils literal notranslate"><span class="pre">hb_interval</span></code> and <code class="docutils literal notranslate"><span class="pre">quiesce_timeout</span></code>, just repeat all steps
omitting setting time values on step 3.</p>
</td>
</tr>
</tbody>
</table>
</section>
<section id="vqq-122-intel-qat-hw-doesn-t-support-number-of-vfs-sr-iov-configuration">
<h2>VQQ-122 – Intel<sup>®</sup> QAT HW doesn’t support “Number of VFs” SR-IOV configuration<a class="headerlink" href="#vqq-122-intel-qat-hw-doesn-t-support-number-of-vfs-sr-iov-configuration" title="Permalink to this headline"></a></h2>
<table class="docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>Title</strong></p></td>
<td><p>Intel<sup>®</sup> QAT HW doesn’t support “Number of VFs” SR-IOV
configuration</p></td>
</tr>
<tr class="row-even"><td><p><strong>Reference</strong></p></td>
<td><p>VQQ-122</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Description</strong></p></td>
<td><p>If the system administrator configures the number of VFs less than the
total number of VFs supported by PF, the driver will fail to attach the
device.</p></td>
</tr>
<tr class="row-even"><td><p><strong>Implication</strong></p></td>
<td><p>The system administrator can’t configure the VF number less than the
total VFs.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Resolution</strong></p></td>
<td><p>Enable all VFs per endpoint. If a smaller number was previously
configured, and no VFs are available, reconfigure SR-IOV with the
maximum number of VFs.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="intel-qat-hw-c6xx-and-200xx-qat-doesn-t-support-vf-reset-functionality">
<h2>Intel<sup>®</sup> QAT HW (c6xx and 200xx QAT) doesn’t support VF reset functionality<a class="headerlink" href="#intel-qat-hw-c6xx-and-200xx-qat-doesn-t-support-vf-reset-functionality" title="Permalink to this headline"></a></h2>
<table class="docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>Title</strong></p></td>
<td><p>Intel<sup>®</sup> QAT HW (c6xx and 200xx QAT) doesn’t support VF reset
functionality</p></td>
</tr>
<tr class="row-even"><td><p><strong>Reference</strong></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Description</strong></p></td>
<td><p>The Intel<sup>®</sup> QAT HW (c6xx and 200xx QAT) doesn’t implement the
SR-IOV specification section, which requires VFs to support Function
Level Reset (FLR)</p></td>
</tr>
<tr class="row-even"><td><p><strong>Implication</strong></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Resolution</strong></p></td>
<td><p>ESXi PF SR-IOV driver emulates VFLR for HW which doesn’t support it.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="intel-qat-hw-requires-masking-some-errors-in-aer-register-due-to-hw-limitations">
<h2>Intel<sup>®</sup> QAT HW requires masking some errors in AER register due to HW limitations<a class="headerlink" href="#intel-qat-hw-requires-masking-some-errors-in-aer-register-due-to-hw-limitations" title="Permalink to this headline"></a></h2>
<table class="docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>Title</strong></p></td>
<td><p>Intel<sup>®</sup> QAT HW requires masking some errors in AER register due
to HW limitations</p></td>
</tr>
<tr class="row-even"><td><p><strong>Reference</strong></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Description</strong></p></td>
<td><p>QAT HW does not process Completion Timeout, Unsupported Request, and
Uncorrectable Internal Errors correctly, and the associated bits should
be masked in the AER mask register to prevent NMI failures which may
lead to platform crash.</p></td>
</tr>
<tr class="row-even"><td><p><strong>Implication</strong></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Resolution</strong></p></td>
<td><p>ESXi PF SR-IOV driver masking appropriate errors to mitigate platform
crashes.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="vmware-esxi-may-require-to-manually-toggle-passthrough-for-intel-qat-vfs">
<h2>VMware ESXi may require to manually toggle passthrough for Intel<sup>®</sup> QAT VFs<a class="headerlink" href="#vmware-esxi-may-require-to-manually-toggle-passthrough-for-intel-qat-vfs" title="Permalink to this headline"></a></h2>
<table class="docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>Title</strong></p></td>
<td><p>VMware ESXi may require to manually toggle passthrough for
Intel<sup>®</sup> QAT VFs</p></td>
</tr>
<tr class="row-even"><td><p><strong>Reference</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>Description</strong></p></td>
<td><p>Due to limitations in VMware ESXi 7.0, Intel<sup>®</sup> QAT VFs can
remain unmarked for passthrough, which requires a passthrough to be done
manually in the vSphere UI.</p></td>
</tr>
<tr class="row-even"><td><p><strong>Implication</strong></p></td>
<td><p>System administrator need to manually toggle passthrough for VFs before
assigning to VMs</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Resolution</strong></p></td>
<td><p>Upgrade to 7.0 Update 1 or newer release of ESXi.
If upgrade is not possible please follow next steps to toggle passthru
manually on VMware ESXi 7.0:</p>
<ol class="arabic simple">
<li><p>Connect to the target ESXi host via Web User Interface (UI)</p></li>
<li><p>In the left pane, click on Manage.</p></li>
<li><p>Choose Hardware tab.</p></li>
<li><p>Using checkboxes select Intel<sup>®</sup> Co-processor devices that have
Disabled passthrough state.</p></li>
<li><p>Click on Toggle passthrough button to enable passthrough for disabled
devices.</p></li>
</ol>
</td>
</tr>
</tbody>
</table>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright Intel Corporation.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>